<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Personalized Questions – Moultrie Mobile Career Match</title>
  <style>
    :root {
      --mm-green: #1e3d12;
      --mm-green-soft: #2d5a1a;
      --mm-green-block: #274e16;
      --mm-yellow: #e8c547;
      --mm-yellow-bright: #f5d84d;
      --mm-bg: #f6f4ee;
      --mm-card: #fff;
      --mm-text: #1c1c1c;
      --mm-muted: #5c5c5c;
      --mm-border: rgba(30,61,18,0.12);
      --radius: 12px;
      --radius-sm: 8px;
      --shadow: 0 2px 12px rgba(30,61,18,0.06);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--mm-text);
      background: var(--mm-bg);
      line-height: 1.5;
    }
    .site-header {
      background: var(--mm-green);
      color: white;
      padding: 0.875rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 1rem;
      box-shadow: 0 2px 16px rgba(0,0,0,0.08);
    }
    .site-logo { font-weight: 700; font-size: 1.25rem; letter-spacing: 0.02em; }
    .site-logo a { color: white; text-decoration: none; }
    .site-logo span { color: var(--mm-yellow-bright); }
    .main-nav { display: flex; gap: 0.25rem; flex-wrap: wrap; }
    .main-nav a {
      color: rgba(255,255,255,0.92);
      text-decoration: none;
      padding: 0.5rem 1rem;
      border-radius: 999px;
      font-size: 0.9rem;
      font-weight: 500;
      transition: background 0.2s, color 0.2s;
    }
    .main-nav a:hover { background: rgba(255,255,255,0.12); color: white; }
    .main-nav a.active { background: var(--mm-yellow-bright); color: var(--mm-green); }
    main {
      max-width: 1280px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }
    h1 {
      font-size: 1.75rem;
      font-weight: 800;
      color: var(--mm-green);
      margin: 0 0 0.5rem;
    }
    .page-intro {
      margin: 0 0 1.5rem;
      color: var(--mm-muted);
      line-height: 1.6;
    }
    form {
      background: var(--mm-card);
      border: 1px solid var(--mm-border);
      padding: 1.5rem;
      display: grid;
      gap: 1.25rem;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .field {
      display: grid;
      gap: 0.35rem;
    }
    .field label {
      font-weight: 600;
      font-size: 0.95rem;
      color: var(--mm-green);
    }
    .field small {
      font-size: 0.8rem;
      color: var(--mm-muted);
    }
    .field textarea,
    .field select,
    .field input[type="text"] {
      padding: 0.5rem 0.6rem;
      border-radius: 0;
      border: 2px solid var(--mm-green);
      font-family: inherit;
      font-size: 0.95rem;
      background: var(--mm-bg);
      color: var(--mm-text);
    }
    .field textarea {
      min-height: 80px;
      resize: vertical;
    }
    .field-options {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      font-size: 0.95rem;
    }
    .field-options label {
      font-weight: 500;
      color: var(--mm-text);
    }
    .field-options input {
      margin-right: 0.35rem;
    }
    .actions {
      margin-top: 0.5rem;
      display: flex;
      gap: 0.75rem;
    }
    .btn {
      border: 0;
      border-radius: 0;
      padding: 0.6rem 1.25rem;
      font-size: 0.95rem;
      font-weight: 700;
      cursor: pointer;
      text-transform: none;
    }
    .btn-primary {
      background: #e8f0e4;
      color: var(--mm-green);
      border: 3px solid var(--mm-green);
    }
    .btn-primary:hover {
      background: #dcead8;
    }
    .btn-ghost {
      background: transparent;
      color: var(--mm-green);
      border: 2px solid var(--mm-green);
    }
    .btn-ghost:hover {
      background: var(--mm-green);
      color: var(--mm-yellow);
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="site-logo"><a href="index.html">Moultrie <span>Mobile</span></a></div>
    <nav class="main-nav">
      <a href="about.html">About</a>
      <a href="index.html#home">Home</a>
      <a href="index.html#employee">Prospective employee</a>
      <a href="index.html#employer">Employer</a>
    </nav>
  </header>
  <main>
    <h1>Personalized questions</h1>
    <p class="page-intro">
      Help the AI understand you beyond your resume. Your answers, plus your visibility choice below,
      control what employers can see.
    </p>

    <div id="consent-section" class="field">
      <p>
        Before you answer these questions, please confirm that you consent to Moultrie Mobile securely
        storing your responses to improve your job matches.
      </p>
      <div class="actions">
        <button id="consent-yes" type="button" class="btn btn-primary">Yes, I consent</button>
        <button id="consent-no" type="button" class="btn btn-ghost">No, I do not consent</button>
      </div>
    </div>

    <form id="questions-form">
      <div class="field">
        <label for="candidate-name">Your name</label>
        <small>Required if you choose to be visible to employers.</small>
        <input type="text" id="candidate-name" name="name" placeholder="e.g. Jordan Smith" />
      </div>
      <div class="field">
        <label for="candidate-email">Email</label>
        <small>So employers can contact you.</small>
        <input type="email" id="candidate-email" name="email" placeholder="you@example.com" />
      </div>
      <div class="field">
        <label for="candidate-phone">Phone (optional)</label>
        <input type="text" id="candidate-phone" name="phone" placeholder="(555) 000-0000" />
      </div>
      <div class="field">
        <label for="energizes">What kind of work most energizes you?</label>
        <small>For example: solving complex problems, being in the field, working with people, building systems.</small>
        <textarea id="energizes" name="energizes"></textarea>
      </div>

      <div class="field">
        <label for="environment">What kind of work environment helps you do your best work?</label>
        <select id="environment" name="environment">
          <option value="">Select one</option>
          <option value="independent">Mostly independent, clear goals</option>
          <option value="collaborative">Highly collaborative, team-focused</option>
          <option value="field">In the field / hands-on work</option>
          <option value="office">Office-based / structured schedule</option>
          <option value="hybrid">Mix of field and office</option>
        </select>
      </div>

      <div class="field">
        <label for="schedule">What does a sustainable schedule look like for you?</label>
        <small>Share anything about hours, travel, seasonality, or flexibility that really matters.</small>
        <textarea id="schedule" name="schedule"></textarea>
      </div>

      <div class="field">
        <label>Do you want your information and matches to be visible to potential employers?</label>
        <small>
          If you choose <strong>Yes</strong>, your name and contact details can be shown to hiring managers when you are a match for their jobs.
          If you choose <strong>No</strong>, your data stays private and will not be shown on employer dashboards.
        </small>
        <div class="field-options">
          <label>
            <input type="radio" name="visibility" value="public" />
            Yes — make my profile and matches visible to potential employers.
          </label>
          <label>
            <input type="radio" name="visibility" value="private" />
            No — keep my information and matches private unless I change this later.
          </label>
        </div>
      </div>

      <div class="actions">
        <button type="submit" class="btn btn-primary">Save answers</button>
        <button type="button" class="btn btn-ghost" onclick="history.back()">Cancel</button>
      </div>
    </form>
  </main>
  <script>
    (function () {
      var form = document.getElementById('questions-form');
      var STORAGE_KEY = 'moultrie_opted_in_candidates';

      function getStoredCandidates() {
        try {
          var raw = localStorage.getItem(STORAGE_KEY);
          return raw ? JSON.parse(raw) : [];
        } catch (e) { return []; }
      }

      function saveCandidate(profile) {
        var list = getStoredCandidates();
        list.push(profile);
        try { localStorage.setItem(STORAGE_KEY, JSON.stringify(list)); } catch (e) {}
      }

      form.addEventListener('submit', function (e) {
        e.preventDefault();
        var name = (document.getElementById('candidate-name').value || '').trim();
        var email = (document.getElementById('candidate-email').value || '').trim();
        var phone = (document.getElementById('candidate-phone').value || '').trim();
        var visibility = (document.querySelector('input[name="visibility"]:checked') || {}).value;

        try { localStorage.setItem('moultrie_visible_to_employers', visibility); } catch (e) {}
        if (visibility === 'public') {
          var bestJobTitle = '';
          var match = 0;
          var jobMatches = [];
          try {
            var matches = sessionStorage.getItem('mmJobMatches') || localStorage.getItem('moultrie_resume_job_matches');
            if (matches) {
              var arr = JSON.parse(matches);
              if (arr && arr.length) {
                var first = arr[0];
                var pct0 = first.matchPct != null ? first.matchPct : (first.match != null ? first.match : (first.overall != null ? first.overall : 0));
                if (typeof pct0 === 'number') match = pct0;
                if (first.title) bestJobTitle = first.title;
                jobMatches = arr.map(function (j) {
                  var p = j.matchPct != null ? j.matchPct : (j.match != null ? j.match : (j.overall != null ? j.overall : 0));
                  return { title: j.title, matchPct: typeof p === 'number' ? p : 0 };
                });
              }
            }
          } catch (err) {}
          var role = bestJobTitle ? (bestJobTitle + ' candidate') : 'General candidate';
          var resumeText = '';
          try {
            var raw = sessionStorage.getItem('mmResumeText') || localStorage.getItem('moultrie_resume_text') || '';
            resumeText = (raw && raw.length) ? (raw.length > 80000 ? raw.slice(0, 80000) : raw) : '';
          } catch (e) {}
          var diagnostic = {};
          try {
            var out = JSON.parse(localStorage.getItem('moultrie_personalized') || '{}');
            diagnostic = { sectors: out.sectors, workMode: out['work-mode'], traits: out.traits, priorities: out.priorities };
          } catch (e) {}
          function generateInboxToken() {
            return 'mm_' + Date.now() + '_' + Math.random().toString(36).slice(2, 11);
          }
          var list = getStoredCandidates();
          var existing = list.filter(function (c) { return (c.email || '').toLowerCase() === (email || '').toLowerCase(); })[0];
          var inboxToken = (existing && existing.inboxToken) || generateInboxToken();
          list = list.filter(function (c) { return (c.email || '').toLowerCase() !== (email || '').toLowerCase(); });
          list.push({
            name: name || 'Candidate',
            email: email || '',
            phone: phone || '',
            role: role,
            match: match,
            bestJobTitle: bestJobTitle,
            jobMatches: jobMatches,
            resumeText: resumeText,
            jobKey: 'general',
            public: true,
            diagnostic: diagnostic,
            inboxToken: inboxToken
          });
          try {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
            localStorage.setItem('moultrie_my_inbox_token', inboxToken);
          } catch (e) {}
        }

        window.location.href = 'index.html#employee';
      });
    })();
  </script>
</body>
</html>

